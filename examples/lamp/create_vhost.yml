---
# include file, can not be used as a standalone playbook

- name: Create document root
  file:
      path: "/var/www/{{ host_name }}/public_html"
      state: directory
      owner: www-data
      group: www-data
      mode: 0774
- name: Copy example PHP file
  copy:
      src: files/index.php
      dest: "/var/www/{{ host_name }}/public_html"
      owner: www-data
      group: www-data
      mode: 0644
- name: Create vhost entry
  template:
      src: templates/vhost.j2
      dest: "/etc/apache2/sites-available/{{ host_name }}.conf"
  notify: restart apache
- name: Enable vhost
  file:
      src: "/etc/apache2/sites-available/{{ host_name }}.conf"
      dest: "/etc/apache2/sites-enabled/{{ host_name }}.conf"
      state: link
